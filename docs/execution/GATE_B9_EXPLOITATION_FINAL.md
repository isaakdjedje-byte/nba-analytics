# B9 - Dossier Exploitation ML Final

**Date:** 2026-02-10  
**Session:** B9 (J7)  
**Statut:** FINAL  
**Version:** 1.0

---

## üéØ COMMANDES OFFICIELLES (POST-MIGRATION)

### 1. Pr√©dictions (remplace `run_predictions.py`)
```bash
# Commande officielle
python run_predictions_optimized.py [OPTIONS]

Options disponibles:
  --update     Mettre √† jour les r√©sultats des matchs
  --report     G√©n√©rer le rapport de performance
  --train      R√©entra√Æner le mod√®le optimis√©
  --health     V√©rifier la sant√© du syst√®me
  --drift      V√©rifier le data drift
  --legacy     Utiliser le mod√®le V3 (non optimis√©)
```

### 2. Entra√Ænement
```bash
python src/ml/pipeline/train_unified.py
```
**Output:** `models/unified/model_xgb_unified.joblib`

### 3. Backtest
```bash
python src/ml/pipeline/backtest_hybrid_master_v2.py
```

### 4. R√©entra√Ænement Auto
```bash
python -c "from src.ml.pipeline.auto_retrain import AutoRetrainer; AutoRetrainer().trigger_retrain()"
```

---

## ‚úÖ CHECKLIST RUN (√Ä EX√âCUTER)

### Avant chaque utilisation
- [ ] V√©rifier que le mod√®le est charg√©: `ls models/unified/model_xgb_unified.joblib`
- [ ] V√©rifier les features: `ls data/features/historical/` doit contenir des fichiers

### Commande de v√©rification rapide
```bash
# Test complet en une ligne
python run_predictions_optimized.py --health && \
python -c "from src.ml.pipeline.train_unified import UnifiedTrainer; print('TRAIN OK')" && \
python -c "from src.ml.pipeline.backtest_hybrid_master_v2 import HybridBacktesterV2; print('BACKTEST OK')" && \
python -c "from src.ml.pipeline.auto_retrain import AutoRetrainer; print('RETRAIN OK')" && \
echo "‚úì CHA√éNE CANONIQUE OP√âRATIONNELLE"
```

### En cas d'erreur
1. V√©rifier logs: `tail -f logs/*.log`
2. Tester sant√©: `python run_predictions_optimized.py --health`
3. Rollback si n√©cessaire (voir section Rollback)

---

## üìÖ CALENDRIER CONTR√îLES

### DAILY (Quotidien)
**Heure:** 08:00  
**Responsable:** Ops  
**Dur√©e:** 2 minutes

```bash
# Check rapide
python run_predictions_optimized.py --health
```

**Crit√®res:**
- [ ] Statut: HEALTHY
- [ ] Aucune erreur critique
- [ ] Pr√©dictions g√©n√©r√©es (si matchs aujourd'hui)

### WEEKLY (Hebdomadaire)
**Jour:** Lundi  
**Heure:** 09:00  
**Responsable:** ML Team  
**Dur√©e:** 10 minutes

```bash
# Tests complets
python -m pytest tests/unit/ -q

# V√©rification drift
python run_predictions_optimized.py --drift

# Rapport performance
python run_predictions_optimized.py --report
```

**Crit√®res:**
- [ ] Tests: 100% pass
- [ ] Drift: < 5% (acceptable)
- [ ] Performance: stable vs baseline

### MONTHLY (Mensuel)
**Jour:** 1er du mois  
**Heure:** 10:00  
**Responsable:** ML Lead  
**Dur√©e:** 30 minutes

```bash
# Review compl√®te
python src/ml/pipeline/train_unified.py  # R√©entra√Ænement
python src/ml/pipeline/backtest_hybrid_master_v2.py  # Validation

# Archivage
ls -lh models/unified/
ls -lh data/features/historical/

# Backup
cp -r models/unified/ backup/models_$(date +%Y%m)
```

**Crit√®res:**
- [ ] Nouveau mod√®le entra√Æn√©
- [ ] M√©triques backtest OK
- [ ] Backup cr√©√©
- [ ] Documentation √† jour

---

## üö® ROLLBACK OP√âRATIONNEL

### Situations d√©clenchantes
- Erreur critique en production
- D√©gradation performance > 10%
- Impossibilit√© de g√©n√©rer pr√©dictions

### Proc√©dure de rollback (2 m√©thodes)

#### M√©thode 1: Backup fichier (rapide)
```bash
# Restaurer wrapper depuis backup archive
cp archive/wrapper_run_predictions_FINAL_*.py run_predictions.py

# V√©rifier
python run_predictions.py --help
```

#### M√©thode 2: Git tag (recommand√©)
```bash
# Revenir au point B7 (avant retrait)
git checkout b7-pre-removal-20260210_1347 -- run_predictions.py

# Ou utiliser tag B7_VALIDATED
git checkout B7_VALIDATED -- run_predictions.py

# V√©rifier
python run_predictions.py --help
```

### Post-rollback
- [ ] Tester ancienne commande
- [ ] Notifier √©quipe
- [ ] Ouvrir ticket incident
- [ ] Planifier correction

---

## üìû CONTACTS & ESCALADE

**Niveau 1 - Support Ops:**
- Canal: #dev-support
- Responsable: On-call Ops
- Actions: V√©rification logs, tests basiques

**Niveau 2 - ML Team:**
- Canal: #ml-team
- Responsable: B
- Actions: Debugging, rollback, r√©entra√Ænement

**Niveau 3 - Escalade:**
- Canal: #incidents
- Responsable: Tech Lead
- Actions: D√©cision architecture, rollback majeur

---

## üìä M√âTRIQUES CL√âS

### √Ä surveiller
| M√©trique | Cible | Alert if |
|----------|-------|----------|
| Accuracy mod√®le | > 65% | < 60% |
| Drift donn√©es | < 5% | > 10% |
| Temps pr√©diction | < 2s | > 5s |
| Tests pass | 100% | < 95% |

### Commandes de monitoring
```bash
# Accuracy courante
grep "accuracy" models/unified/training_summary.json

# Dernier drift
tail -1 logs/drift_monitoring.log

# Tests
python -m pytest tests/unit/ --tb=no -q
```

---

## üìã R√âSUM√â EX√âCUTION

### Commandes essentielles (√† m√©moriser)
```bash
# 1. V√©rification sant√©
python run_predictions_optimized.py --health

# 2. Pr√©dictions
python run_predictions_optimized.py --update

# 3. Rapport
python run_predictions_optimized.py --report

# 4. Tests
python -m pytest tests/unit/ -q
```

### Fichiers critiques
- `run_predictions_optimized.py` - Entrypoint principal
- `models/unified/model_xgb_unified.joblib` - Mod√®le actif
- `data/features/historical/` - Features historiques
- `logs/` - Logs syst√®me

---

## ‚úÖ VALIDATION FINALE B9

- [x] Commandes officielles document√©es
- [x] Checklist run cr√©√©e
- [x] Calendrier contr√¥les d√©fini (daily/weekly/monthly)
- [x] Rollback test√© et valid√©
- [x] Contacts & escalade document√©s
- [x] M√©triques cl√©s identifi√©es
- [x] Dossier exploitation final complet

**STATUT:** B9 READY ‚úÖ  
**CHA√éNE CANONIQUE ML:** OP√âRATIONNELLE

---

*Document version 1.0 - G√©n√©r√© le 2026-02-10*  
*Session B9 - Handover exploitation ML final*
