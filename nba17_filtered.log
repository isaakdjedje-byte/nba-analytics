:: loading settings :: url = jar:file:/C:/Users/isaac/AppData/Roaming/Python/Python314/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: C:\Users\isaac\.ivy2\cache
The jars for the packages stored in: C:\Users\isaac\.ivy2\jars
io.delta#delta-spark_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-1ffcd678-8b1b-4eb0-99ee-c7a1fc4299d5;1.0
	confs: [default]
	found io.delta#delta-spark_2.12;3.0.0 in central
	found io.delta#delta-storage;3.0.0 in central
	found org.antlr#antlr4-runtime;4.9.3 in local-m2-cache
:: resolution report :: resolve 483ms :: artifacts dl 20ms
	:: modules in use:
	io.delta#delta-spark_2.12;3.0.0 from central in [default]
	io.delta#delta-storage;3.0.0 from central in [default]
	org.antlr#antlr4-runtime;4.9.3 from local-m2-cache in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-1ffcd678-8b1b-4eb0-99ee-c7a1fc4299d5
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/16ms)
26/02/06 23:52:06 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
26/02/06 23:52:09 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
2026-02-06 23:52:12,707 - INFO - ============================================================
2026-02-06 23:52:12,707 - INFO - NBA-17: Nettoyage des données joueurs
2026-02-06 23:52:12,707 - INFO - Période: 2000-2026 (joueurs ayant joué pendant cette période)
2026-02-06 23:52:12,707 - INFO - ============================================================
2026-02-06 23:52:12,707 - INFO - Chargement et fusion des sources de données...
2026-02-06 23:52:12,707 - INFO - Chargement all_players_historical.json...
2026-02-06 23:52:12,727 - INFO - 5103 joueurs de base chargés
2026-02-06 23:52:12,727 - INFO - Enrichissement avec roster 2023-24...
2026-02-06 23:52:12,731 - INFO - 532 joueurs enrichis depuis le roster
2026-02-06 23:52:12,732 - INFO - Enrichissement avec CSV critiques...
2026-02-06 23:52:13,053 - INFO - 48 joueurs enrichis depuis CSV
2026-02-06 23:52:13,057 - INFO - Filtrage strict 2016+: 638 joueurs à enrichir (vs 4541 initiaux)
2026-02-06 23:52:13,057 - INFO - Enrichissement API pour 638 joueurs...
2026-02-06 23:52:14,451 - INFO - Cache chargé: 824 joueurs en cache
2026-02-06 23:52:14,452 - INFO - 635 joueurs déjà en cache (pas d'appel API)
2026-02-06 23:52:14,453 - INFO - Appels API nécessaires: 3 joueurs
2026-02-06 23:52:14,453 - INFO - API call 1/3: player 279
2026-02-06 23:52:16,080 - INFO - Cache API sauvegardé: 824 joueurs
2026-02-06 23:52:16,080 - INFO - 635 joueurs enrichis depuis API
2026-02-06 23:52:16,081 - INFO - Nettoyage et conversion des données...
2026-02-06 23:52:16,112 - INFO - 5103 joueurs nettoyés
2026-02-06 23:52:16,113 - INFO - Filtrage: 5103 joueurs sans données complètes ignorés
2026-02-06 23:52:16,113 - INFO - Joueurs avec données complètes: 0
2026-02-06 23:52:16,113 - INFO - Validation des données...
2026-02-06 23:52:16,113 - ERROR - Erreur pendant le nettoyage: list index out of range
2026-02-06 23:52:16,114 - ERROR - Traceback (most recent call last):
  File "C:\Users\isaac\nba-analytics\src\processing\clean_players.py", line 774, in run
    if not self.validate_data(players_with_complete_data):
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\isaac\nba-analytics\src\processing\clean_players.py", line 603, in validate_data
    total_cells = len(players) * len(players[0])
                                     ~~~~~~~^^^
IndexError: list index out of range

2026-02-06 23:52:16,137 - INFO - Closing down clientserver connection
SUCCESS: The process with PID 40176 (child process of PID 40668) has been terminated.
SUCCESS: The process with PID 40668 (child process of PID 21768) has been terminated.
SUCCESS: The process with PID 21768 (child process of PID 31772) has been terminated.
