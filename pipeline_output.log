INFO:utils.caching:Cache chargé: 827 joueurs
:: loading settings :: url = jar:file:/C:/Users/isaac/AppData/Roaming/Python/Python314/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: C:\Users\isaac\.ivy2\cache
The jars for the packages stored in: C:\Users\isaac\.ivy2\jars
io.delta#delta-spark_2.12 added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-8728d5f2-2402-4b6f-9156-f02a2ad82535;1.0
	confs: [default]
	found io.delta#delta-spark_2.12;3.0.0 in central
	found io.delta#delta-storage;3.0.0 in central
	found org.antlr#antlr4-runtime;4.9.3 in local-m2-cache
:: resolution report :: resolve 119ms :: artifacts dl 5ms
	:: modules in use:
	io.delta#delta-spark_2.12;3.0.0 from central in [default]
	io.delta#delta-storage;3.0.0 from central in [default]
	org.antlr#antlr4-runtime;4.9.3 from local-m2-cache in [default]
	---------------------------------------------------------------------
	|                  |            modules            ||   artifacts   |
	|       conf       | number| search|dwnlded|evicted|| number|dwnlded|
	---------------------------------------------------------------------
	|      default     |   3   |   0   |   0   |   0   ||   3   |   0   |
	---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-8728d5f2-2402-4b6f-9156-f02a2ad82535
	confs: [default]
	0 artifacts copied, 3 already retrieved (0kB/5ms)
26/02/07 11:26:07 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
26/02/07 11:26:08 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
INFO:processing.silver.stratification:Configuration chargee: configs\silver_stratification.yaml
INFO:processing.silver.validators:Validateur initialise: level='contemporary', seuil_nulls=5%
26/02/07 11:26:10 WARN SparkSession: Using an existing Spark session; only runtime SQL configurations will take effect.
INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:NBA PIPELINE - Bronze -> Silver -> Gold
INFO:pipeline.players_pipeline:Mode: Stratifie (target=all)
INFO:pipeline.players_pipeline:============================================================

INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:STEP: Bronze Layer
INFO:pipeline.players_pipeline:============================================================

INFO:processing.bronze.players_bronze:============================================================
INFO:processing.bronze.players_bronze:COUCHE BRONZE - Ingestion données brutes
INFO:processing.bronze.players_bronze:============================================================
INFO:processing.bronze.players_bronze:Chargement all_players_historical.json...
INFO:processing.bronze.players_bronze:5103 joueurs de base chargés
INFO:processing.bronze.players_bronze:532 joueurs enrichis depuis le roster
INFO:processing.bronze.players_bronze:48 joueurs enrichis depuis CSV
INFO:processing.bronze.players_bronze:Filtrage 2016+: 638 joueurs à enrichir
INFO:utils.caching:638 joueurs déjà en cache (pas d'appel API)
INFO:processing.bronze.players_bronze:Tous les joueurs sont déjà en cache!
INFO:processing.bronze.players_bronze:827 joueurs mis à jour depuis le cache
INFO:processing.bronze.players_bronze:Sauvegarde couche Bronze...
INFO:processing.bronze.players_bronze:Bronze sauvegardé: data\bronze\players_bronze.json (5103 joueurs)
INFO:processing.bronze.validate_bronze:Validation Bronze: 5103 joueurs
INFO:processing.bronze.validate_bronze:Taux de complétion Bronze: 57.7%
INFO:processing.bronze.validate_bronze:\u2705 Validation Bronze OK
INFO:pipeline.players_pipeline:\u2705 Bronze Layer terminé (0.2s)
INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:STEP: Silver Layer
INFO:pipeline.players_pipeline:Mode: Stratifie (target=all)
INFO:pipeline.players_pipeline:============================================================

INFO:pipeline.players_pipeline:Initialisation Data Mesh Stratifier...
INFO:processing.silver.data_mesh_stratifier:Configuration chargée: 5 produits
INFO:processing.silver.data_mesh_stratifier:DataMeshStratifier initialisé avec config: configs/data_products.yaml
INFO:processing.silver.players_silver:Bronze chargé: 5103 joueurs
INFO:pipeline.players_pipeline:Nettoyage des donnees Bronze...
INFO:processing.silver.players_silver:Nettoyage des données...
INFO:processing.silver.players_silver:5103 joueurs nettoyés
INFO:pipeline.players_pipeline:Stratification Data Mesh en cours...
INFO:processing.silver.data_mesh_stratifier:============================================================
INFO:processing.silver.data_mesh_stratifier:DATA MESH STRATIFICATION
INFO:processing.silver.data_mesh_stratifier:============================================================
INFO:processing.silver.data_mesh_stratifier:Input: 5103 joueurs
INFO:processing.silver.data_mesh_stratifier:
INFO:processing.silver.data_mesh_stratifier:[1/5] Création dataset RAW...
INFO:processing.silver.data_mesh_stratifier:[2/5] Filtrage niveau BRONZE...
INFO:processing.silver.data_mesh_stratifier:  players_bronze: 1328/5103 joueurs (26.0%)
INFO:processing.silver.data_mesh_stratifier:[3/5] Filtrage niveau SILVER...
INFO:processing.silver.data_mesh_stratifier:  players_silver: 158/1328 joueurs (11.9%)
INFO:processing.silver.data_mesh_stratifier:[4/5] Filtrage niveau GOLD...
INFO:processing.silver.data_mesh_stratifier:  players_gold: 158/158 joueurs (100.0%)
INFO:processing.silver.data_mesh_stratifier:[5/5] Création sous-catégorie TIER2...
INFO:processing.silver.data_mesh_stratifier:  players_contemporary_tier2: 885 joueurs
INFO:processing.silver.data_mesh_stratifier:
INFO:processing.silver.data_mesh_stratifier:============================================================
INFO:processing.silver.data_mesh_stratifier:STRATIFICATION TERMINÉE
INFO:processing.silver.data_mesh_stratifier:============================================================
INFO:processing.silver.data_mesh_stratifier:Durée: 0.02s
INFO:processing.silver.data_mesh_stratifier:
INFO:processing.silver.data_mesh_stratifier:Produits créés:
INFO:processing.silver.data_mesh_stratifier:  [RAW     ] raw                             5103 joueurs (65.1% complet)
INFO:processing.silver.data_mesh_stratifier:  [BRONZE  ] bronze                          1328 joueurs (94.0% complet)
INFO:processing.silver.data_mesh_stratifier:  [SILVER  ] silver                           158 joueurs (100.0% complet)
INFO:processing.silver.data_mesh_stratifier:  [GOLD    ] gold                             158 joueurs (100.0% complet)
INFO:processing.silver.data_mesh_stratifier:  [SILVER_TIER2] contemporary_tier2               885 joueurs (92.6% complet)
INFO:processing.silver.data_mesh_stratifier:============================================================
INFO:pipeline.players_pipeline:Generation rapports qualite...
INFO:processing.silver.data_mesh_stratifier:Rapport qualité exporté: data\gold\data_quality_report.json
INFO:processing.silver.data_mesh_stratifier:Lineage exporté: data\gold\lineage.json
INFO:pipeline.players_pipeline:
Traitement produit 'raw' [raw]:
INFO:pipeline.players_pipeline:  Joueurs: 5103
INFO:pipeline.players_pipeline:  Completude: 65.1%
INFO:pipeline.players_pipeline:  Taux nulls: 33.54%
INFO:pipeline.players_pipeline:Sauvegarde JSON: data\silver\players_raw\players.json (5103 joueurs)
INFO:pipeline.players_pipeline:Sauvegarde: data\silver\players_raw (5103 joueurs)
INFO:pipeline.players_pipeline:\u2705 Produit 'raw' sauvegarde: data/silver/players_raw/
INFO:pipeline.players_pipeline:
Traitement produit 'bronze' [bronze]:
INFO:pipeline.players_pipeline:  Joueurs: 1328
INFO:pipeline.players_pipeline:  Completude: 94.0%
INFO:pipeline.players_pipeline:  Taux nulls: 5.97%
INFO:pipeline.players_pipeline:Sauvegarde JSON: data\silver\players_bronze\players.json (1328 joueurs)
INFO:pipeline.players_pipeline:Sauvegarde: data\silver\players_bronze (1328 joueurs)
INFO:pipeline.players_pipeline:\u2705 Produit 'bronze' sauvegarde: data/silver/players_bronze/
INFO:pipeline.players_pipeline:
Traitement produit 'silver' [silver]:
INFO:pipeline.players_pipeline:  Joueurs: 158
INFO:pipeline.players_pipeline:  Completude: 100.0%
INFO:pipeline.players_pipeline:  Taux nulls: 0.00%
INFO:pipeline.players_pipeline:Sauvegarde JSON: data\silver\players_silver\players.json (158 joueurs)
INFO:pipeline.players_pipeline:Sauvegarde: data\silver\players_silver (158 joueurs)
INFO:pipeline.players_pipeline:\u2705 Produit 'silver' sauvegarde: data/silver/players_silver/
INFO:pipeline.players_pipeline:
Traitement produit 'gold' [gold]:
INFO:pipeline.players_pipeline:  Joueurs: 158
INFO:pipeline.players_pipeline:  Completude: 100.0%
INFO:pipeline.players_pipeline:  Taux nulls: 0.00%
INFO:pipeline.players_pipeline:Sauvegarde JSON: data\silver\players_gold\players.json (158 joueurs)
INFO:pipeline.players_pipeline:Sauvegarde: data\silver\players_gold (158 joueurs)
INFO:pipeline.players_pipeline:\u2705 Produit 'gold' sauvegarde: data/silver/players_gold/
INFO:pipeline.players_pipeline:
Traitement produit 'contemporary_tier2' [silver_tier2]:
INFO:pipeline.players_pipeline:  Joueurs: 885
INFO:pipeline.players_pipeline:  Completude: 92.6%
INFO:pipeline.players_pipeline:  Taux nulls: 7.35%
INFO:pipeline.players_pipeline:Sauvegarde JSON: data\silver\players_contemporary_tier2\players.json (885 joueurs)
INFO:pipeline.players_pipeline:Sauvegarde: data\silver\players_contemporary_tier2 (885 joueurs)
INFO:pipeline.players_pipeline:\u2705 Produit 'contemporary_tier2' sauvegarde: data/silver/players_contemporary_tier2/
INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:DATA MESH - RESUME
INFO:pipeline.players_pipeline:============================================================
INFO:pipeline.players_pipeline:Produits crees: 5/5
INFO:pipeline.players_pipeline:Taux reduction: 96.9%
INFO:pipeline.players_pipeline:Rapport qualite: data/gold/data_quality_report.json
INFO:pipeline.players_pipeline:Lineage: data/gold/lineage.json
INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:RÉSUMÉ D'EXÉCUTION
INFO:pipeline.players_pipeline:============================================================
INFO:pipeline.players_pipeline:
Durée totale: 0.5 secondes
INFO:pipeline.players_pipeline:
\u2705 Bronze Layer
INFO:pipeline.players_pipeline:   Statut: success
INFO:pipeline.players_pipeline:   Durée: 0.2s
INFO:pipeline.players_pipeline:   Joueurs: 5103
INFO:pipeline.players_pipeline:
============================================================
INFO:pipeline.players_pipeline:\u2705 PIPELINE TERMINE AVEC SUCCES
INFO:pipeline.players_pipeline:============================================================

======================================================================
NBA ANALYTICS PLATFORM
Architecture Medallion - Bronze -> Silver -> Gold
======================================================================

Mode: Joueurs 2000-2026 uniquement
Optimise pour ML (recommande)

Mode Stratifie: ACTIVE
Target: all + intermediate + contemporary

Execution: Pipeline complet (Bronze -> Silver -> Gold)

[SUCCES] Pipeline termine avec succes!
INFO:py4j.clientserver:Closing down clientserver connection
SUCCESS: The process with PID 34620 (child process of PID 23256) has been terminated.
SUCCESS: The process with PID 23256 (child process of PID 37464) has been terminated.
SUCCESS: The process with PID 37464 (child process of PID 34128) has been terminated.
